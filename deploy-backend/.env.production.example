# ============================================
# PRODUCTION ENVIRONMENT VARIABLES
# ============================================
# Copy this file to .env.production and fill with your values
# NEVER commit .env.production to git!

# ============================================
# DATABASE (PostgreSQL)
# ============================================
POSTGRES_USER=crm_user
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD_HERE
POSTGRES_DB=crm_whatsapp_saas

# Connection pool (optional tuning)
# DATABASE_CONNECTION_LIMIT=20
# DATABASE_POOL_TIMEOUT=60

# ============================================
# REDIS
# ============================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD_HERE

# Redis connection options
# REDIS_DB=0
# REDIS_KEY_PREFIX=crm:

# ============================================
# SECURITY & AUTHENTICATION
# ============================================
# Generate JWT secrets with: openssl rand -base64 32
JWT_SECRET=CHANGE_ME_JWT_SECRET_MIN_32_CHARS
JWT_REFRESH_SECRET=CHANGE_ME_REFRESH_SECRET_MIN_32_CHARS

# Token expiration times
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# Generate encryption key with: openssl rand -hex 32
# CRITICAL: This key is used to encrypt sensitive data in the database
# Must be exactly 64 hex characters (32 bytes)
ENCRYPTION_KEY=CHANGE_ME_64_HEX_CHARS_REQUIRED_FOR_AES256

# ============================================
# APPLICATION
# ============================================
NODE_ENV=production
PORT=3001

# Frontend URL (CORS) - Can be multiple URLs separated by comma
FRONTEND_URL=https://seu-frontend.vercel.app

# Base domain (used for SSL and multi-tenant)
# Examples:
#   - With domain: api.yourdomain.com
#   - IP only: 72.61.39.235
BASE_DOMAIN=api.yourdomain.com

# API Version
API_VERSION=v1

# ============================================
# WHATSAPP BUSINESS API
# ============================================
WHATSAPP_API_VERSION=v21.0
WHATSAPP_API_URL=https://graph.facebook.com
WHATSAPP_WEBHOOK_VERIFY_TOKEN=CHANGE_ME_WEBHOOK_VERIFY_TOKEN

# Default WhatsApp config (can be overridden per tenant)
# WHATSAPP_DEFAULT_TIMEOUT=30000

# ============================================
# RATE LIMITING
# ============================================
# Override default rate limits (optional)
# RATE_LIMIT_GENERAL=60
# RATE_LIMIT_LOGIN=5
# RATE_LIMIT_MESSAGE_SEND=50

# ============================================
# N8N INTEGRATION (Optional)
# ============================================
N8N_API_KEY=CHANGE_ME_N8N_API_KEY
# N8N_WEBHOOK_URL=https://your-n8n-instance.com/webhook

# ============================================
# SUPER ADMIN (Initial setup)
# ============================================
SUPER_ADMIN_EMAIL=admin@yourdomain.com
SUPER_ADMIN_PASSWORD=CHANGE_ME_IN_PRODUCTION

# ============================================
# MONITORING & OBSERVABILITY
# ============================================
# Sentry Error Tracking
SENTRY_DSN=https://your-key@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Logging
LOG_LEVEL=info
LOG_FORMAT=json

# Prometheus Metrics
METRICS_ENABLED=true
METRICS_PORT=9090

# Health Check
HEALTH_CHECK_INTERVAL=30000

# ============================================
# EMAIL (Optional - for notifications)
# ============================================
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_SECURE=false
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-app-password
# EMAIL_FROM=noreply@yourdomain.com
# EMAIL_FROM_NAME=CRM WhatsApp

# ============================================
# STORAGE (for media files)
# ============================================
# Storage provider: local, s3, gcs
STORAGE_PROVIDER=local
STORAGE_LOCAL_PATH=/app/uploads

# S3 Configuration (if using S3)
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_REGION=us-east-1
# S3_BUCKET=crm-whatsapp-media

# ============================================
# QUEUE CONFIGURATION
# ============================================
# Bull Queue Redis (can be different from cache Redis)
QUEUE_REDIS_HOST=redis
QUEUE_REDIS_PORT=6379
QUEUE_REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD_HERE

# Queue processing
QUEUE_CONCURRENCY=5
QUEUE_MAX_RETRIES=3
QUEUE_RETRY_DELAY=5000

# ============================================
# SECURITY HEADERS
# ============================================
# Content Security Policy
CSP_DIRECTIVES="default-src 'self'; script-src 'self' 'unsafe-inline'"

# CORS Configuration
CORS_MAX_AGE=86400
CORS_CREDENTIALS=true

# ============================================
# FEATURE FLAGS
# ============================================
FEATURE_WEBSOCKET_ENABLED=true
FEATURE_WEBHOOK_VALIDATION=true
FEATURE_AUTO_ASSIGN_CONVERSATION=false
FEATURE_MESSAGE_ENCRYPTION=true

# ============================================
# PERFORMANCE TUNING
# ============================================
# Node.js
NODE_OPTIONS="--max-old-space-size=2048"

# Express
BODY_SIZE_LIMIT=10mb
UPLOAD_SIZE_LIMIT=50mb

# Database
DB_SLOW_QUERY_LOG=true
DB_SLOW_QUERY_TIME=1000

# ============================================
# BACKUP CONFIGURATION (Optional)
# ============================================
# BACKUP_ENABLED=true
# BACKUP_SCHEDULE="0 2 * * *"
# BACKUP_RETENTION_DAYS=30
# BACKUP_S3_BUCKET=crm-backups